{% extends 'webapp/base.html' %}

{% block content %}
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-3.6.1.min.js"></script>

    <div class="card border-primary p-4 mb-4">

        <h2 class="text-center mb-4">Genres Analytics</h2>

        {% if stats_genres %}
        <div class="card bg-secondary mb-4">
            <div class="card-body">
                <h4 class="card-title">Genre Popularity:</h4>
                <p><strong>Average films per genre:</strong> {{ stats_genres.mean|floatformat:1 }}</p>
                <p><strong>Max films in genre:</strong> {{ stats_genres.max|floatformat:0 }}</p>
            </div>
        </div>
        {% endif %}

        <div class="mb-4 text-center">
            <form method="get" class="mb-3">
                <label class="me-2">Chart Type:</label>
                <select name="chart_type" class="form-select d-inline-block w-auto" onchange="this.form.submit()">
                    <option value="bar" {% if chart_type == 'bar' %}selected{% endif %}>Bar Chart</option>
                    <option value="line" {% if chart_type == 'line' %}selected{% endif %}>Line Chart</option>
                    <option value="pie" {% if chart_type == 'pie' %}selected{% endif %}>Pie Chart</option>
                </select>
            </form>

            {{ chart_genres|safe }}
        </div>

        {% if bokeh_div %}
        <div class="card border-info p-3">
            <h2 class="text-center">Genre Popularity (Bokeh)</h2>
            {{ bokeh_div|safe }}
            {{ bokeh_script|safe }}
        </div>
        {% endif %}

    </div>
{% endblock %}